import*as t from"@wordpress/interactivity";var e,n,r={d:function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},a=(e={getContext:function(){return t.getContext},getElement:function(){return t.getElement},store:function(){return t.store}},n={},r.d(n,e),n);let o=!1,i=0,g=[];const{state:l,actions:s,callbacks:c}=(0,a.store)("surecart/lightbox",{state:{images:[],currentImageIndex:-1,get currentImageId(){return l.currentImageIndex>-1&&l.images.length>0?l.images[l.currentImageIndex]:null},get currentImage(){return l.metadata[l.currentImageId]},get hasNavigation(){return l.images.length>1},get hasNextImage(){return l.currentImageIndex+1<l.images.length},get hasPreviousImage(){return l.currentImageIndex-1>=0},get overlayOpened(){return null!==l.currentImageId},get roleAttribute(){return l.overlayOpened?"dialog":null},get ariaModal(){return l.overlayOpened?"true":null},get enlargedSrc(){return l.currentImage.uploadedSrc||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},get imgStyles(){return l.overlayOpened&&"object-fit:cover;"},get isContentHidden(){const t=(0,a.getContext)();return l.overlayEnabled&&l.currentImageId===t.imageId},get isContentVisible(){const t=(0,a.getContext)();return!l.overlayEnabled&&l.currentImageId===t.imageId},get imageButtonRight(){const{imageId:t}=(0,a.getContext)();return l.metadata[t].imageButtonRight},get imageButtonTop(){const{imageId:t}=(0,a.getContext)();return l.metadata[t].imageButtonTop}},actions:{showLightbox(){const{imageId:t,images:e}=(0,a.getContext)();l.metadata[t].imageRef?.complete&&(l.scrollTopReset=document.documentElement.scrollTop,l.scrollLeftReset=document.documentElement.scrollLeft,l.images=(e||[t]).filter((e=>{const n=l.metadata[e],r=n?.imageRef,a=r&&function(t){for(;t;){if("none"===window.getComputedStyle(t).display)return!1;t=t.parentElement}return!0}(r);return n?.galleryId===l.metadata[t]?.galleryId&&a})),c.setCurrentImageIndex(t),l.overlayEnabled=!0,c.setOverlayStyles(),g=[],document.querySelectorAll("body > :not(.sc-lightbox-overlay)").forEach((t=>{t.hasAttribute("inert")||(t.setAttribute("inert",""),g.push(t))})))},hideLightbox(){l.overlayEnabled&&(l.showClosingAnimation=!0,l.overlayEnabled=!1,setTimeout((function(){l.currentImage.buttonRef.focus({preventScroll:!0}),l.currentImageIndex=-1,l.images=[]}),450),g.forEach((t=>{t.removeAttribute("inert")})),g=[])},showPreviousImage(t){l.hasNavigation&&(t.stopPropagation(),l.hasPreviousImage&&(l.currentImageIndex=l.currentImageIndex-1,c.setOverlayStyles()))},showNextImage(t){l.hasNavigation&&(t.stopPropagation(),l.hasNextImage&&(l.currentImageIndex=l.currentImageIndex+1,c.setOverlayStyles()))},handleKeydown(t){l.overlayEnabled&&("Escape"===t.key&&s.hideLightbox(),"ArrowLeft"===t.key?s.showPreviousImage(t):"ArrowRight"===t.key&&s.showNextImage(t))},handleTouchMove(t){l.overlayEnabled&&t.preventDefault()},handleTouchStart(){o=!0},handleTouchEnd(){i=Date.now(),o=!1},handleScroll(){l.overlayOpened&&!o&&Date.now()-i>450&&window.scrollTo(l.scrollLeftReset,l.scrollTopReset)}},callbacks:{setCurrentImageIndex(t){const e=l.images.findIndex((e=>e.toString()===t.toString()));l.currentImageIndex=e},setOverlayStyles(){if(!l.overlayEnabled)return;let{naturalWidth:t,naturalHeight:e,offsetWidth:n,offsetHeight:r}=l.currentImage.imageRef,{x:a,y:o}=l.currentImage.imageRef.getBoundingClientRect();const i=t/e;let g=n/r;if("contain"===l.currentImage.scaleAttr)if(i>g){const t=n/i;o+=(r-t)/2,r=t}else{const t=r*i;a+=(n-t)/2,n=t}g=n/r;let s=parseFloat(l.currentImage.targetWidth&&"none"!==l.currentImage.targetWidth?l.currentImage.targetWidth:t),c=parseFloat(l.currentImage.targetHeight&&"none"!==l.currentImage.targetHeight?l.currentImage.targetHeight:e),d=s/c,m=s,u=c,h=s,I=c;if(i.toFixed(2)!==d.toFixed(2)){if(i>d){const t=s/i;c-t>s?(c=t,s=t*i):c=s/i}else{const t=c*i;s-t>c?(s=t,c=t/i):s=c*i}h=s,I=c,d=s/c,g>d?(m=s,u=m/g):(u=c,m=u*g)}(n>h||r>I)&&(h=n,I=r);let f=0;window.innerWidth>480?f=l.hasNavigation?140:80:window.innerWidth>1920&&(f=160);const x=Math.min(window.innerWidth-f,h),p=Math.min(window.innerHeight-80,I);g>x/p?(h=x,I=h/g):(I=p,h=I*g);const y=n/h,b=s*(h/m),v=c*(I/u);l.overlayStyles=`\n\t\t\t\t:root {\n\t\t\t\t\t--sc-lightbox--initial-top-position: ${o}px;\n\t\t\t\t\t--sc-lightbox--initial-left-position: ${a}px;\n\t\t\t\t\t--sc-lightbox--container-width: ${h+1}px;\n\t\t\t\t\t--sc-lightbox--container-height: ${I+1}px;\n\t\t\t\t\t--sc-lightbox--image-width: ${b}px;\n\t\t\t\t\t--sc-lightbox--image-height: ${v}px;\n\t\t\t\t\t--sc-lightbox--scale: ${y};\n\t\t\t\t\t--sc-lightbox--scrollbar-width: ${window.innerWidth-document.documentElement.clientWidth}px;\n\t\t\t\t}\n\t\t\t\t`},setScreenReaderText(){const{ref:t}=(0,a.getElement)();l.overlayEnabled?t.textContent=l.currentImage.screenReaderText:t.textContent=""},setImageRef(){const{imageId:t}=(0,a.getContext)(),{ref:e}=(0,a.getElement)();l.metadata[t].imageRef=e,l.metadata[t].currentSrc=e.currentSrc,c.setButtonStyles()},setButtonStyles(){const{imageId:t}=(0,a.getContext)(),{ref:e}=(0,a.getElement)(),{naturalWidth:n,naturalHeight:r,offsetWidth:o,offsetHeight:i}=e;if(0===n||0===r)return;const g=e.parentElement,s=e.parentElement.clientWidth;let c=e.parentElement.clientHeight;const d=g.querySelector("figcaption");if(d){const t=window.getComputedStyle(d);["absolute","fixed"].includes(t.position)||(c=c-d.offsetHeight-parseFloat(t.marginTop)-parseFloat(t.marginBottom))}const m=c-i,u=s-o;let h=m+16,I=u+16;if("contain"===l.metadata[t].scaleAttr){const t=n/r;t>=o/i?(h=(i-o/t)/2+m+16,I=u+16):(h=m+16,I=(o-i*t)/2+u+16)}l.metadata[t].imageButtonTop=h,l.metadata[t].imageButtonRight=I},setOverlayFocus(){if(l.overlayEnabled){const{ref:t}=(0,a.getElement)();t.focus()}},initTriggerButton(){const{imageId:t}=(0,a.getContext)(),{ref:e}=(0,a.getElement)();l.metadata[t].buttonRef=e}}});